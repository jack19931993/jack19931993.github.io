var wasSearching=!1;function asyncLogin(a,e,n){var o={};o.password=n,o.email=e,o.async=!0,$.ajax({type:"POST",url:"/login",data:o,success:function(e){if(e.errors){$("#UnAuthenticatedMenu").removeClass("hidden"),$("#LoadingMenu").addClass("hidden"),$("#LoadingMessage").text(""),$("#ModalLoginForm").show(),$("#ModalLoginLoading").hide(),$(".login-error-message").empty();for(var n=0;n<e.errors.length;n++)$(".login-error-message").append(e.errors[n]+"<br>");var o=$(".login-error-container");o.removeClass("hidden"),o.removeClass("bg-warning text-warning"),o.addClass("bg-danger text-danger")}else e.content?1===$("#LoginBreadCrumb").length?window.location="":(!0===e.content.testMode&&$(".test-mode").show(),$("#LoadingMenu").addClass("hidden"),$("#LoginIcon").addClass("hidden"),$("#AuthIcon").removeClass("hidden"),$("#AuthenticatedMenu").removeClass("hidden"),$(".login-error-container").addClass("hidden"),$(".login-error-message").text(""),$("#NameDisplay").text(e.content.firstName+" "+e.content.lastName),$("#RegisterButton").addClass("hidden"),$(".sign-up-bar").addClass("hidden"),e.content.administrator&&$(".admin-only").each(function(){$(this).removeClass("hidden")}),checkSearch(),"modal"===a&&$("#ModalLoginCancel").click()):location.reload()},error:function(e,n,o){if($("#UnAuthenticatedMenu").removeClass("hidden"),$("#LoadingMenu").addClass("hidden"),$("#LoadingMessage").text(""),$("#ModalLoginForm").show(),$("#ModalLoginLoading").hide(),$(".login-error-message").empty(),Array.isArray(e.responseJSON.errors))for(var a=0;a<e.responseJSON.errors.length;a++)$(".login-error-message").append(e.responseJSON.errors[a]+"<br>");else for(var a in e.responseJSON.errors)e.responseJSON.errors.hasOwnProperty(a)&&$(".login-error-message").append(e.responseJSON.errors[a][0]+"<br>");var i=$(".login-error-container");i.removeClass("hidden"),i.removeClass("bg-warning text-warning"),i.addClass("bg-danger text-danger")}}),$("#UnAuthenticatedMenu").addClass("hidden"),$("#LoadingMenu").removeClass("hidden"),$("#LoadingLogout").addClass("hidden"),$("#LoadingLogin").removeClass("hidden"),$("#ModalLoginForm").hide(),$("#ModalLoginLoading").show()}function toggleUserMenu(){var e=$("#SlideMenu");$("#ToggleSlideMenu");return e.hasClass("closed-slide-menu")?openSlideMenu():closeSlideMenu(),!1}function openSlideMenu(){var e=$("#SlideMenu");$("#ToggleSlideMenu").show(),e.removeClass("closed-slide-menu"),e.addClass("open-slide-menu"),$("#MenuButton").addClass("active"),$("#UnAuthenticatedMenu").hasClass("hidden")||$("#LoginEmail").focus()}function closeSlideMenu(){var e=$("#SlideMenu"),n=$("#ToggleSlideMenu");e.addClass("closed-slide-menu"),e.removeClass("open-slide-menu"),$("#MenuButton").removeClass("active"),n.hide()}function redirect(e){var n=window.location.href,o=n.indexOf("."),a=n.substring(o);""!=e&&(console.log(e),window.location="https://"+e+a)}function resizeLoginWidget(){var e=$(window).height(),n=$("#header").height();$("#SlideMenu").height(e-n+100)}function checkPosition(){0===$(document).scrollTop()?$(".header-accent-bar").removeClass("hidden"):$(".header-accent-bar").addClass("hidden")}function checkSearch(){if(!1!==wasSearching){var e=$("#SlideMenu");$("#MenuButton").removeClass("active"),e.addClass("closed-slide-menu"),e.removeClass("open-slide-menu"),$(".login-error-container").addClass("hidden"),$("#AuthIcon").removeClass("current-page-header"),$("#LoginIcon").removeClass("current-page-header"),$("#"+wasSearching).submit(),$(".auth-tab").off("click")}}$(document).ready(function(){$("#SlideMenu");resizeLoginWidget(),checkPosition(),setTimeout(function(){$("#SlideMenu").css("opacity",1)},300),$(window).resize(resizeLoginWidget),$(document).scroll(checkPosition),$("body").click(function(e){"SlideMenu"!=e.target.id&&0==$(e.target).parents("#SlideMenu").length&&"MenuButton"!=e.target.id&&0==$(e.target).parents("#MenuButton").length&&closeSlideMenu()}),$("#loginButton").click(function(){asyncLogin("header",$("#LoginEmail").val(),$("#password").val())}),$("#ModalLoginButton").click(function(){asyncLogin("modal",$("#ModalEmail").val(),$("#ModalPassword").val())}),$(".modal-login-input").keyup(function(e){13===(e.keyCode?e.keyCode:e.which)&&asyncLogin("modal",$("#ModalEmail").val(),$("#ModalPassword").val())}),$("#loginButton").parent().submit(function(e){e.preventDefault(e)}),$("#logoutButton").click(function(){$.ajax({type:"POST",url:"/logout",data:{},success:function(){var e=window.location.pathname;"/contact"!==e&&"/register"!==e&&"/login"!==e&&"/"!==e?window.location.href="/":($("#AuthIcon").addClass("hidden"),$("#LoginIcon").removeClass("hidden"),$("#LoadingMenu").addClass("hidden"),$("#UnAuthenticatedMenu").toggleClass("hidden"),$("#RegisterButton").removeClass("hidden"),$(".admin-only").each(function(){$(this).addClass("hidden")}),$(".sign-up-bar").removeClass("hidden"),$(".test-mode").hide())},error:function(e,n,o){console.error(n,o.toString())}}),$("#AuthenticatedMenu").toggleClass("hidden"),$("#LoadingMenu").removeClass("hidden"),$("#LoadingLogin").addClass("hidden"),$("#LoadingLogout").removeClass("hidden")})});